{
  "hash": "1e3420cf246f5be276b6745e6e7e44f4",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"Homework7\"\nauthor: \"hg.park\"\ndate: \"2024-09-02\"\ncategories: [Homework]\njupyter: python3\n---\n\n\n# ADP 교재 37-38p 연습문제\n\n## ADP 표본점수\n\n2022년에 실시 된 ADP 실기 시험의 통계파트 표준점수는 평균이 30, 표준편차가 5인 정규분포를 따른다고 한다.\n\n### 1. ADP 실기 시험의 통계파트 표준점수의 밀도함수를 그려보세요.\n\n::: {#b3fa5c72 .cell execution_count=1}\n``` {.python .cell-code}\n# X ~ N(30, 5^2)\nfrom scipy.stats import norm\nimport numpy as np\n\nx = np.linspace(10, 50, 500)\npdf_values = norm.pdf(x, loc=30, scale=5)\n\nimport matplotlib.pyplot as plt\n\nplt.plot(x, pdf_values)\n```\n\n::: {.cell-output .cell-output-display}\n![](chi_files/figure-html/cell-2-output-1.png){width=579 height=411}\n:::\n:::\n\n\n### 2. ADP 수험생을 임의로 1명을 선택하여 통계 점수를 조회했을때 45점 보다 높은 점수를 받았을 확률을 구하세요.\n\n::: {#ba1bf668 .cell execution_count=2}\n``` {.python .cell-code}\n# P(X>45) = ?\n1 - norm.cdf(45, loc=30, scale=5)\n```\n\n::: {.cell-output .cell-output-display execution_count=17}\n```\nnp.float64(0.0013498980316301035)\n```\n:::\n:::\n\n\n### 3. 슬통이는 상위 10%에 해당하는 점수를 얻었다고 한다면, 슬통이의 점수는 얼마인지 계산해보세요.\n\n::: {#f4e881ec .cell execution_count=3}\n``` {.python .cell-code}\nnorm.ppf(0.9, loc=30, scale=5)\n```\n\n::: {.cell-output .cell-output-display execution_count=18}\n```\nnp.float64(36.407757827723)\n```\n:::\n:::\n\n\n### 4. 슬기로운 통계생활의 해당 회차 수강생은 16명이었다고 한다. 16명의 통계 파트 점수를 평균내었을 때, 이 평균값이 따르는 분포의 확률밀도 함수를 1번의 그래프와 겹쳐 그려보세요.\n\n::: {#02b27ea2 .cell execution_count=4}\n``` {.python .cell-code}\n# X_bar 표본, n = 16\n# X_bar ~ N(30, 5^2 / 16)\nx = np.linspace(10, 50, 500)\nx_bar_pdf_values = norm.pdf(x, loc=30, scale=np.sqrt((5**2)/16))\npdf_values = norm.pdf(x, loc=30, scale=5)\nplt.plot(x, pdf_values)\nplt.plot(x, x_bar_pdf_values, color=\"red\")\n```\n\n::: {.cell-output .cell-output-display}\n![](chi_files/figure-html/cell-5-output-1.png){width=579 height=411}\n:::\n:::\n\n\n### 5. 슬기로운 통계생활 ADP 반 수강생들의 통계점수를 평균내었다고 할 때, 이 값이 38점보다 높게 나올 확률을 구하세요\n\n::: {#68c64e14 .cell execution_count=5}\n``` {.python .cell-code}\n# X_bar 표본, n = 16\n# X_bar ~ N(30, 5^2 / 16)\n# P(X_bar>38) = ? \n1 - norm.cdf(38, loc=30, scale=np.sqrt((5**2)/16))\n```\n\n::: {.cell-output .cell-output-display execution_count=20}\n```\nnp.float64(7.76885222819601e-11)\n```\n:::\n:::\n\n\n## Covid 19 발병률\n\nCovid‑19의 발병률은 1%라고 한다. 다음은 이번 코로나 사태로 인하여 코로나 의심 환자들 1,085 명을 대상으로 슬통 회사의 “다잡아” 키트를 사용하여 양성 반응을 체크한 결과이다. ![covid 양성 반응 결과](covid19.jpg)\n\n### 1. 다잡아 키트가 코로나 바이러스에 걸린 사람을 양성으로 잡아낼 확률을 계산하세요.\n\n::: {#3ccb2c48 .cell execution_count=6}\n``` {.python .cell-code}\n# P(키트 양성|실제 양성)\n# P(키트 양성 ∩ 실제 양성) / P(실제 양성)\nimport pandas as pd\ncovid = pd.DataFrame({\n    \"구분\": [\"키트 양성\", \"키트 음성\"],\n    \"실제 양성\": [370, 15],\n    \"실제 음성\": [10, 690]\n})\ncovid\n```\n\n::: {.cell-output .cell-output-display execution_count=21}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>구분</th>\n      <th>실제 양성</th>\n      <th>실제 음성</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>키트 양성</td>\n      <td>370</td>\n      <td>10</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>키트 음성</td>\n      <td>15</td>\n      <td>690</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {#e7d2613d .cell execution_count=7}\n``` {.python .cell-code}\n# P(키트 양성|실제 양성)\n# P(키트 양성 ∩ 실제 양성) / P(실제 양성)\ncovid.loc[0, '실제 양성'] / covid.loc[:, '실제 양성'].sum()\n```\n\n::: {.cell-output .cell-output-display execution_count=22}\n```\nnp.float64(0.961038961038961)\n```\n:::\n:::\n\n\n### 2. 슬통 회사에서 다잡아 키트를 사용해 양성으로 나온 사람이 실제로는 코로나 바이러스에 걸려있을 확률을 97%라며, 키트의 우수성을 주장했다. 이 주장이 옳지 않은 이유를 서술하세요.\n\n::: {#6b62bfac .cell execution_count=8}\n``` {.python .cell-code}\n# P(실제 양성|키트 양성)\n# P(실제 양성 ∩ 키트 양성) / P(키트 양성)\ncovid.loc[0, '실제 양성'] / covid[covid['구분']=='키트 양성'][['실제 양성','실제 음성']].sum(axis='columns')\n```\n\n::: {.cell-output .cell-output-display execution_count=23}\n```\n0    0.973684\ndtype: float64\n```\n:::\n:::\n\n\n→ 표본 집단의 유병률과 모집단의 유병률 차이가 있기 때문.\n\n### 3. Covid‑19 발병률을 사용하여, 키트의 결과값이 양성으로 나온 사람이 실제로 코로나 바이러스에 걸려있을 확률을 구하세요.\n\n::: {#fe5493c1 .cell execution_count=9}\n``` {.python .cell-code}\n# 코로나 발병률 = 0.01\n# P(실제 양성) = 0.01 이란 의미\n# P(실제 양성|키트 양성) = P(실제 양성 ∩ 키트 양성) / P(키트 양성) =  P(실제양성)P(키트양성|실제양성) / {P(실제양성)P(키트양성|실제양성) + P(실제음성)P(키트양성|실제음성)}\n# a = P(실제양성)P(키트양성|실제양성)\n# b = P(실제음성)P(키트양성|실제음성) = P(실제음성) * (P(키트양성∩실제음성)/P(실제음성))\n# a / ( a + b )\na = 0.01 * (covid.loc[0, '실제 양성'] / covid.loc[:, '실제 양성'].sum())\nb = 0.99 * (covid.loc[0, '실제 음성'] / covid.loc[:, '실제 음성'].sum())\nprob = a / (a + b)\nprint(f\"따라서 키트의 결과값이 양성으로 나온 사람이 실제로 코로나 바이러스에 걸려있을 확률은 {prob*100:.3f}%\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n따라서 키트의 결과값이 양성으로 나온 사람이 실제로 코로나 바이러스에 걸려있을 확률은 40.459%\n```\n:::\n:::\n\n\n## 카이제곱분포와 표본분산\n\n$$\n자유도가 𝑘인 카이제곱분포를 따르는 확률변수 𝑋 를 X \\sim \\chi^2(k)과 같이 나타내고, \n이 확률변수의 확률밀도함수는 다음과 같습니다.\n$$ $$\nf_X(x; k) = \\frac{1}{2^{k/2} \\Gamma(k/2)} x^{k/2-1} e^{-x/2}\n$$\n\n### 1. 자유도가 4인 카이제곱분포의 확률밀도함수를 그려보세요.\n\n::: {#9fcc6344 .cell execution_count=10}\n``` {.python .cell-code}\nfrom scipy.stats import chi2\nimport numpy as np\nimport matplotlib.pyplot as plt\n\nk = np.linspace(0, 40, 500)\ny = chi2.pdf(k, df=4)\nplt.plot(k, y)\n```\n\n::: {.cell-output .cell-output-display}\n![](chi_files/figure-html/cell-11-output-1.png){width=587 height=411}\n:::\n:::\n\n\n### 2. 다음의 확률을 구해보세요. 𝑃 (3 ≤ 𝑋 ≤ 5)\n\n::: {#38566f46 .cell execution_count=11}\n``` {.python .cell-code}\nchi2.cdf(5, df=4) - chi2.cdf(3, df=4)\n```\n\n::: {.cell-output .cell-output-display execution_count=26}\n```\nnp.float64(0.27052790518742903)\n```\n:::\n:::\n\n\n### 3. 자유도가 4인 카이제곱분포에서 크기가 1000인 표본을 뽑은 후, 히스토그램을 그려보세요.\n\n::: {#6449746f .cell execution_count=12}\n``` {.python .cell-code}\nnp.random.seed(20240902)\nk=chi2.rvs(df=4, size=1000)\nplt.hist(k)\n```\n\n::: {.cell-output .cell-output-display execution_count=27}\n```\n(array([237., 295., 227., 111.,  58.,  35.,  19.,   9.,   7.,   2.]),\n array([ 0.06952138,  1.84067646,  3.61183154,  5.38298663,  7.15414171,\n         8.92529679, 10.69645188, 12.46760696, 14.23876204, 16.00991713,\n        17.78107221]),\n <BarContainer object of 10 artists>)\n```\n:::\n\n::: {.cell-output .cell-output-display}\n![](chi_files/figure-html/cell-13-output-2.png){width=575 height=411}\n:::\n:::\n\n\n### 4. 자유도가 4인 카이제곱분포를 따르는 확률변수에서 나올 수 있는 값 중 상위 5%에 해당하는값은 얼마인지 계산해보세요.\n\n::: {#f10fd870 .cell execution_count=13}\n``` {.python .cell-code}\nchi2.ppf(0.95, df=4)\n```\n\n::: {.cell-output .cell-output-display execution_count=28}\n```\nnp.float64(9.487729036781154)\n```\n:::\n:::\n\n\n### 5. 3번에서 뽑힌 표본값들 중 상위 5%에 위치한 표본의 값은 얼마인가요?\n\n::: {#40aa2b85 .cell execution_count=14}\n``` {.python .cell-code}\nnp.percentile(k, 95)\n```\n\n::: {.cell-output .cell-output-display execution_count=29}\n```\nnp.float64(9.853854661290491)\n```\n:::\n:::\n\n\n### 6. 평균이 3, 표준편차가 2인 정규분포를 따르는 확률변수에서 크기가 20인 표본, $$𝑥_{1}$$, ..., $$𝑥_{20}$$,을뽑은 후 표본분산을 계산한 것을 $$s_{1}^2$$이라 생각해보죠. 다음을 수행해보세요!\n\n• 같은 방법으로 500개의 $$s^2$$ 들, $$s_{1}^2$$, $$s_{2}^2$$, ..., $$s_{500}^2$$ 발생시킵니다. \n• 발생한 500개의 $$s^2$$ 들 각각에 4.75를 곱하고, 그것들의 히스토그램을 그려보세요. (히스토그램을 그릴 때 probability = TRUE 옵션을 사용해서 그릴 것) \n• 위에서 그린 히스토그램에 자유도가 19인 카이제곱분포 확률밀도함수를 겹쳐그려보세요.\n\n::: {#b00f8046 .cell execution_count=15}\n``` {.python .cell-code}\nnp.random.seed(20240902)\nvar_samples = []\n\nfor i in range(500):\n    x = norm.rvs(loc=3, scale=2, size=20)\n    var_samples.append(np.var(x, ddof=1))\n\nvar_samples = np.array(var_samples) * 4.75\nplt.hist(var_samples, density=True)\n\nnp.random.seed(20240902)\nk = np.linspace(0, var_samples.max(), 500)\ny = chi2.pdf(k, df=19)\nplt.plot(k, y, color=\"red\")\n```\n\n::: {.cell-output .cell-output-display}\n![](chi_files/figure-html/cell-16-output-1.png){width=579 height=411}\n:::\n:::\n\n\n",
    "supporting": [
      "chi_files"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\" data-relocate-top=\"true\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}