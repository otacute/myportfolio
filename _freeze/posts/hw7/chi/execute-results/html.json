{
  "hash": "1e3420cf246f5be276b6745e6e7e44f4",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"Homework7\"\nauthor: \"hg.park\"\ndate: \"2024-09-02\"\ncategories: [Homework]\njupyter: python3\n---\n\n\n# ADP êµì¬ 37-38p ì—°ìŠµë¬¸ì œ\n\n## ADP í‘œë³¸ì ìˆ˜\n\n2022ë…„ì— ì‹¤ì‹œ ëœ ADP ì‹¤ê¸° ì‹œí—˜ì˜ í†µê³„íŒŒíŠ¸ í‘œì¤€ì ìˆ˜ëŠ” í‰ê· ì´ 30, í‘œì¤€í¸ì°¨ê°€ 5ì¸ ì •ê·œë¶„í¬ë¥¼ ë”°ë¥¸ë‹¤ê³  í•œë‹¤.\n\n### 1. ADP ì‹¤ê¸° ì‹œí—˜ì˜ í†µê³„íŒŒíŠ¸ í‘œì¤€ì ìˆ˜ì˜ ë°€ë„í•¨ìˆ˜ë¥¼ ê·¸ë ¤ë³´ì„¸ìš”.\n\n::: {#b3fa5c72 .cell execution_count=1}\n``` {.python .cell-code}\n# X ~ N(30, 5^2)\nfrom scipy.stats import norm\nimport numpy as np\n\nx = np.linspace(10, 50, 500)\npdf_values = norm.pdf(x, loc=30, scale=5)\n\nimport matplotlib.pyplot as plt\n\nplt.plot(x, pdf_values)\n```\n\n::: {.cell-output .cell-output-display}\n![](chi_files/figure-html/cell-2-output-1.png){width=579 height=411}\n:::\n:::\n\n\n### 2. ADP ìˆ˜í—˜ìƒì„ ì„ì˜ë¡œ 1ëª…ì„ ì„ íƒí•˜ì—¬ í†µê³„ ì ìˆ˜ë¥¼ ì¡°íšŒí–ˆì„ë•Œ 45ì  ë³´ë‹¤ ë†’ì€ ì ìˆ˜ë¥¼ ë°›ì•˜ì„ í™•ë¥ ì„ êµ¬í•˜ì„¸ìš”.\n\n::: {#ba1bf668 .cell execution_count=2}\n``` {.python .cell-code}\n# P(X>45) = ?\n1 - norm.cdf(45, loc=30, scale=5)\n```\n\n::: {.cell-output .cell-output-display execution_count=17}\n```\nnp.float64(0.0013498980316301035)\n```\n:::\n:::\n\n\n### 3. ìŠ¬í†µì´ëŠ” ìƒìœ„ 10%ì— í•´ë‹¹í•˜ëŠ” ì ìˆ˜ë¥¼ ì–»ì—ˆë‹¤ê³  í•œë‹¤ë©´, ìŠ¬í†µì´ì˜ ì ìˆ˜ëŠ” ì–¼ë§ˆì¸ì§€ ê³„ì‚°í•´ë³´ì„¸ìš”.\n\n::: {#f4e881ec .cell execution_count=3}\n``` {.python .cell-code}\nnorm.ppf(0.9, loc=30, scale=5)\n```\n\n::: {.cell-output .cell-output-display execution_count=18}\n```\nnp.float64(36.407757827723)\n```\n:::\n:::\n\n\n### 4. ìŠ¬ê¸°ë¡œìš´ í†µê³„ìƒí™œì˜ í•´ë‹¹ íšŒì°¨ ìˆ˜ê°•ìƒì€ 16ëª…ì´ì—ˆë‹¤ê³  í•œë‹¤. 16ëª…ì˜ í†µê³„ íŒŒíŠ¸ ì ìˆ˜ë¥¼ í‰ê· ë‚´ì—ˆì„ ë•Œ, ì´ í‰ê· ê°’ì´ ë”°ë¥´ëŠ” ë¶„í¬ì˜ í™•ë¥ ë°€ë„ í•¨ìˆ˜ë¥¼ 1ë²ˆì˜ ê·¸ë˜í”„ì™€ ê²¹ì³ ê·¸ë ¤ë³´ì„¸ìš”.\n\n::: {#02b27ea2 .cell execution_count=4}\n``` {.python .cell-code}\n# X_bar í‘œë³¸, n = 16\n# X_bar ~ N(30, 5^2 / 16)\nx = np.linspace(10, 50, 500)\nx_bar_pdf_values = norm.pdf(x, loc=30, scale=np.sqrt((5**2)/16))\npdf_values = norm.pdf(x, loc=30, scale=5)\nplt.plot(x, pdf_values)\nplt.plot(x, x_bar_pdf_values, color=\"red\")\n```\n\n::: {.cell-output .cell-output-display}\n![](chi_files/figure-html/cell-5-output-1.png){width=579 height=411}\n:::\n:::\n\n\n### 5. ìŠ¬ê¸°ë¡œìš´ í†µê³„ìƒí™œ ADP ë°˜ ìˆ˜ê°•ìƒë“¤ì˜ í†µê³„ì ìˆ˜ë¥¼ í‰ê· ë‚´ì—ˆë‹¤ê³  í•  ë•Œ, ì´ ê°’ì´ 38ì ë³´ë‹¤ ë†’ê²Œ ë‚˜ì˜¬ í™•ë¥ ì„ êµ¬í•˜ì„¸ìš”\n\n::: {#68c64e14 .cell execution_count=5}\n``` {.python .cell-code}\n# X_bar í‘œë³¸, n = 16\n# X_bar ~ N(30, 5^2 / 16)\n# P(X_bar>38) = ? \n1 - norm.cdf(38, loc=30, scale=np.sqrt((5**2)/16))\n```\n\n::: {.cell-output .cell-output-display execution_count=20}\n```\nnp.float64(7.76885222819601e-11)\n```\n:::\n:::\n\n\n## Covid 19 ë°œë³‘ë¥ \n\nCovidâ€‘19ì˜ ë°œë³‘ë¥ ì€ 1%ë¼ê³  í•œë‹¤. ë‹¤ìŒì€ ì´ë²ˆ ì½”ë¡œë‚˜ ì‚¬íƒœë¡œ ì¸í•˜ì—¬ ì½”ë¡œë‚˜ ì˜ì‹¬ í™˜ìë“¤ 1,085 ëª…ì„ ëŒ€ìƒìœ¼ë¡œ ìŠ¬í†µ íšŒì‚¬ì˜ â€œë‹¤ì¡ì•„â€ í‚¤íŠ¸ë¥¼ ì‚¬ìš©í•˜ì—¬ ì–‘ì„± ë°˜ì‘ì„ ì²´í¬í•œ ê²°ê³¼ì´ë‹¤. ![covid ì–‘ì„± ë°˜ì‘ ê²°ê³¼](covid19.jpg)\n\n### 1. ë‹¤ì¡ì•„ í‚¤íŠ¸ê°€ ì½”ë¡œë‚˜ ë°”ì´ëŸ¬ìŠ¤ì— ê±¸ë¦° ì‚¬ëŒì„ ì–‘ì„±ìœ¼ë¡œ ì¡ì•„ë‚¼ í™•ë¥ ì„ ê³„ì‚°í•˜ì„¸ìš”.\n\n::: {#3ccb2c48 .cell execution_count=6}\n``` {.python .cell-code}\n# P(í‚¤íŠ¸ ì–‘ì„±|ì‹¤ì œ ì–‘ì„±)\n# P(í‚¤íŠ¸ ì–‘ì„± âˆ© ì‹¤ì œ ì–‘ì„±) / P(ì‹¤ì œ ì–‘ì„±)\nimport pandas as pd\ncovid = pd.DataFrame({\n    \"êµ¬ë¶„\": [\"í‚¤íŠ¸ ì–‘ì„±\", \"í‚¤íŠ¸ ìŒì„±\"],\n    \"ì‹¤ì œ ì–‘ì„±\": [370, 15],\n    \"ì‹¤ì œ ìŒì„±\": [10, 690]\n})\ncovid\n```\n\n::: {.cell-output .cell-output-display execution_count=21}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>êµ¬ë¶„</th>\n      <th>ì‹¤ì œ ì–‘ì„±</th>\n      <th>ì‹¤ì œ ìŒì„±</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>í‚¤íŠ¸ ì–‘ì„±</td>\n      <td>370</td>\n      <td>10</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>í‚¤íŠ¸ ìŒì„±</td>\n      <td>15</td>\n      <td>690</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {#e7d2613d .cell execution_count=7}\n``` {.python .cell-code}\n# P(í‚¤íŠ¸ ì–‘ì„±|ì‹¤ì œ ì–‘ì„±)\n# P(í‚¤íŠ¸ ì–‘ì„± âˆ© ì‹¤ì œ ì–‘ì„±) / P(ì‹¤ì œ ì–‘ì„±)\ncovid.loc[0, 'ì‹¤ì œ ì–‘ì„±'] / covid.loc[:, 'ì‹¤ì œ ì–‘ì„±'].sum()\n```\n\n::: {.cell-output .cell-output-display execution_count=22}\n```\nnp.float64(0.961038961038961)\n```\n:::\n:::\n\n\n### 2. ìŠ¬í†µ íšŒì‚¬ì—ì„œ ë‹¤ì¡ì•„ í‚¤íŠ¸ë¥¼ ì‚¬ìš©í•´ ì–‘ì„±ìœ¼ë¡œ ë‚˜ì˜¨ ì‚¬ëŒì´ ì‹¤ì œë¡œëŠ” ì½”ë¡œë‚˜ ë°”ì´ëŸ¬ìŠ¤ì— ê±¸ë ¤ìˆì„ í™•ë¥ ì„ 97%ë¼ë©°, í‚¤íŠ¸ì˜ ìš°ìˆ˜ì„±ì„ ì£¼ì¥í–ˆë‹¤. ì´ ì£¼ì¥ì´ ì˜³ì§€ ì•Šì€ ì´ìœ ë¥¼ ì„œìˆ í•˜ì„¸ìš”.\n\n::: {#6b62bfac .cell execution_count=8}\n``` {.python .cell-code}\n# P(ì‹¤ì œ ì–‘ì„±|í‚¤íŠ¸ ì–‘ì„±)\n# P(ì‹¤ì œ ì–‘ì„± âˆ© í‚¤íŠ¸ ì–‘ì„±) / P(í‚¤íŠ¸ ì–‘ì„±)\ncovid.loc[0, 'ì‹¤ì œ ì–‘ì„±'] / covid[covid['êµ¬ë¶„']=='í‚¤íŠ¸ ì–‘ì„±'][['ì‹¤ì œ ì–‘ì„±','ì‹¤ì œ ìŒì„±']].sum(axis='columns')\n```\n\n::: {.cell-output .cell-output-display execution_count=23}\n```\n0    0.973684\ndtype: float64\n```\n:::\n:::\n\n\nâ†’ í‘œë³¸ ì§‘ë‹¨ì˜ ìœ ë³‘ë¥ ê³¼ ëª¨ì§‘ë‹¨ì˜ ìœ ë³‘ë¥  ì°¨ì´ê°€ ìˆê¸° ë•Œë¬¸.\n\n### 3. Covidâ€‘19 ë°œë³‘ë¥ ì„ ì‚¬ìš©í•˜ì—¬, í‚¤íŠ¸ì˜ ê²°ê³¼ê°’ì´ ì–‘ì„±ìœ¼ë¡œ ë‚˜ì˜¨ ì‚¬ëŒì´ ì‹¤ì œë¡œ ì½”ë¡œë‚˜ ë°”ì´ëŸ¬ìŠ¤ì— ê±¸ë ¤ìˆì„ í™•ë¥ ì„ êµ¬í•˜ì„¸ìš”.\n\n::: {#fe5493c1 .cell execution_count=9}\n``` {.python .cell-code}\n# ì½”ë¡œë‚˜ ë°œë³‘ë¥  = 0.01\n# P(ì‹¤ì œ ì–‘ì„±) = 0.01 ì´ë€ ì˜ë¯¸\n# P(ì‹¤ì œ ì–‘ì„±|í‚¤íŠ¸ ì–‘ì„±) = P(ì‹¤ì œ ì–‘ì„± âˆ© í‚¤íŠ¸ ì–‘ì„±) / P(í‚¤íŠ¸ ì–‘ì„±) =  P(ì‹¤ì œì–‘ì„±)P(í‚¤íŠ¸ì–‘ì„±|ì‹¤ì œì–‘ì„±) / {P(ì‹¤ì œì–‘ì„±)P(í‚¤íŠ¸ì–‘ì„±|ì‹¤ì œì–‘ì„±) + P(ì‹¤ì œìŒì„±)P(í‚¤íŠ¸ì–‘ì„±|ì‹¤ì œìŒì„±)}\n# a = P(ì‹¤ì œì–‘ì„±)P(í‚¤íŠ¸ì–‘ì„±|ì‹¤ì œì–‘ì„±)\n# b = P(ì‹¤ì œìŒì„±)P(í‚¤íŠ¸ì–‘ì„±|ì‹¤ì œìŒì„±) = P(ì‹¤ì œìŒì„±) * (P(í‚¤íŠ¸ì–‘ì„±âˆ©ì‹¤ì œìŒì„±)/P(ì‹¤ì œìŒì„±))\n# a / ( a + b )\na = 0.01 * (covid.loc[0, 'ì‹¤ì œ ì–‘ì„±'] / covid.loc[:, 'ì‹¤ì œ ì–‘ì„±'].sum())\nb = 0.99 * (covid.loc[0, 'ì‹¤ì œ ìŒì„±'] / covid.loc[:, 'ì‹¤ì œ ìŒì„±'].sum())\nprob = a / (a + b)\nprint(f\"ë”°ë¼ì„œ í‚¤íŠ¸ì˜ ê²°ê³¼ê°’ì´ ì–‘ì„±ìœ¼ë¡œ ë‚˜ì˜¨ ì‚¬ëŒì´ ì‹¤ì œë¡œ ì½”ë¡œë‚˜ ë°”ì´ëŸ¬ìŠ¤ì— ê±¸ë ¤ìˆì„ í™•ë¥ ì€ {prob*100:.3f}%\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\në”°ë¼ì„œ í‚¤íŠ¸ì˜ ê²°ê³¼ê°’ì´ ì–‘ì„±ìœ¼ë¡œ ë‚˜ì˜¨ ì‚¬ëŒì´ ì‹¤ì œë¡œ ì½”ë¡œë‚˜ ë°”ì´ëŸ¬ìŠ¤ì— ê±¸ë ¤ìˆì„ í™•ë¥ ì€ 40.459%\n```\n:::\n:::\n\n\n## ì¹´ì´ì œê³±ë¶„í¬ì™€ í‘œë³¸ë¶„ì‚°\n\n$$\nììœ ë„ê°€ ğ‘˜ì¸ ì¹´ì´ì œê³±ë¶„í¬ë¥¼ ë”°ë¥´ëŠ” í™•ë¥ ë³€ìˆ˜ ğ‘‹ ë¥¼ X \\sim \\chi^2(k)ê³¼ ê°™ì´ ë‚˜íƒ€ë‚´ê³ , \nì´ í™•ë¥ ë³€ìˆ˜ì˜ í™•ë¥ ë°€ë„í•¨ìˆ˜ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.\n$$ $$\nf_X(x; k) = \\frac{1}{2^{k/2} \\Gamma(k/2)} x^{k/2-1} e^{-x/2}\n$$\n\n### 1. ììœ ë„ê°€ 4ì¸ ì¹´ì´ì œê³±ë¶„í¬ì˜ í™•ë¥ ë°€ë„í•¨ìˆ˜ë¥¼ ê·¸ë ¤ë³´ì„¸ìš”.\n\n::: {#9fcc6344 .cell execution_count=10}\n``` {.python .cell-code}\nfrom scipy.stats import chi2\nimport numpy as np\nimport matplotlib.pyplot as plt\n\nk = np.linspace(0, 40, 500)\ny = chi2.pdf(k, df=4)\nplt.plot(k, y)\n```\n\n::: {.cell-output .cell-output-display}\n![](chi_files/figure-html/cell-11-output-1.png){width=587 height=411}\n:::\n:::\n\n\n### 2. ë‹¤ìŒì˜ í™•ë¥ ì„ êµ¬í•´ë³´ì„¸ìš”. ğ‘ƒ (3 â‰¤ ğ‘‹ â‰¤ 5)\n\n::: {#38566f46 .cell execution_count=11}\n``` {.python .cell-code}\nchi2.cdf(5, df=4) - chi2.cdf(3, df=4)\n```\n\n::: {.cell-output .cell-output-display execution_count=26}\n```\nnp.float64(0.27052790518742903)\n```\n:::\n:::\n\n\n### 3. ììœ ë„ê°€ 4ì¸ ì¹´ì´ì œê³±ë¶„í¬ì—ì„œ í¬ê¸°ê°€ 1000ì¸ í‘œë³¸ì„ ë½‘ì€ í›„, íˆìŠ¤í† ê·¸ë¨ì„ ê·¸ë ¤ë³´ì„¸ìš”.\n\n::: {#6449746f .cell execution_count=12}\n``` {.python .cell-code}\nnp.random.seed(20240902)\nk=chi2.rvs(df=4, size=1000)\nplt.hist(k)\n```\n\n::: {.cell-output .cell-output-display execution_count=27}\n```\n(array([237., 295., 227., 111.,  58.,  35.,  19.,   9.,   7.,   2.]),\n array([ 0.06952138,  1.84067646,  3.61183154,  5.38298663,  7.15414171,\n         8.92529679, 10.69645188, 12.46760696, 14.23876204, 16.00991713,\n        17.78107221]),\n <BarContainer object of 10 artists>)\n```\n:::\n\n::: {.cell-output .cell-output-display}\n![](chi_files/figure-html/cell-13-output-2.png){width=575 height=411}\n:::\n:::\n\n\n### 4. ììœ ë„ê°€ 4ì¸ ì¹´ì´ì œê³±ë¶„í¬ë¥¼ ë”°ë¥´ëŠ” í™•ë¥ ë³€ìˆ˜ì—ì„œ ë‚˜ì˜¬ ìˆ˜ ìˆëŠ” ê°’ ì¤‘ ìƒìœ„ 5%ì— í•´ë‹¹í•˜ëŠ”ê°’ì€ ì–¼ë§ˆì¸ì§€ ê³„ì‚°í•´ë³´ì„¸ìš”.\n\n::: {#f10fd870 .cell execution_count=13}\n``` {.python .cell-code}\nchi2.ppf(0.95, df=4)\n```\n\n::: {.cell-output .cell-output-display execution_count=28}\n```\nnp.float64(9.487729036781154)\n```\n:::\n:::\n\n\n### 5. 3ë²ˆì—ì„œ ë½‘íŒ í‘œë³¸ê°’ë“¤ ì¤‘ ìƒìœ„ 5%ì— ìœ„ì¹˜í•œ í‘œë³¸ì˜ ê°’ì€ ì–¼ë§ˆì¸ê°€ìš”?\n\n::: {#40aa2b85 .cell execution_count=14}\n``` {.python .cell-code}\nnp.percentile(k, 95)\n```\n\n::: {.cell-output .cell-output-display execution_count=29}\n```\nnp.float64(9.853854661290491)\n```\n:::\n:::\n\n\n### 6. í‰ê· ì´ 3, í‘œì¤€í¸ì°¨ê°€ 2ì¸ ì •ê·œë¶„í¬ë¥¼ ë”°ë¥´ëŠ” í™•ë¥ ë³€ìˆ˜ì—ì„œ í¬ê¸°ê°€ 20ì¸ í‘œë³¸, $$ğ‘¥_{1}$$, ..., $$ğ‘¥_{20}$$,ì„ë½‘ì€ í›„ í‘œë³¸ë¶„ì‚°ì„ ê³„ì‚°í•œ ê²ƒì„ $$s_{1}^2$$ì´ë¼ ìƒê°í•´ë³´ì£ . ë‹¤ìŒì„ ìˆ˜í–‰í•´ë³´ì„¸ìš”!\n\nâ€¢ ê°™ì€ ë°©ë²•ìœ¼ë¡œ 500ê°œì˜ $$s^2$$ ë“¤, $$s_{1}^2$$, $$s_{2}^2$$, ..., $$s_{500}^2$$ ë°œìƒì‹œí‚µë‹ˆë‹¤. \nâ€¢ ë°œìƒí•œ 500ê°œì˜ $$s^2$$ ë“¤ ê°ê°ì— 4.75ë¥¼ ê³±í•˜ê³ , ê·¸ê²ƒë“¤ì˜ íˆìŠ¤í† ê·¸ë¨ì„ ê·¸ë ¤ë³´ì„¸ìš”. (íˆìŠ¤í† ê·¸ë¨ì„ ê·¸ë¦´ ë•Œ probability = TRUE ì˜µì…˜ì„ ì‚¬ìš©í•´ì„œ ê·¸ë¦´ ê²ƒ) \nâ€¢ ìœ„ì—ì„œ ê·¸ë¦° íˆìŠ¤í† ê·¸ë¨ì— ììœ ë„ê°€ 19ì¸ ì¹´ì´ì œê³±ë¶„í¬ í™•ë¥ ë°€ë„í•¨ìˆ˜ë¥¼ ê²¹ì³ê·¸ë ¤ë³´ì„¸ìš”.\n\n::: {#b00f8046 .cell execution_count=15}\n``` {.python .cell-code}\nnp.random.seed(20240902)\nvar_samples = []\n\nfor i in range(500):\n    x = norm.rvs(loc=3, scale=2, size=20)\n    var_samples.append(np.var(x, ddof=1))\n\nvar_samples = np.array(var_samples) * 4.75\nplt.hist(var_samples, density=True)\n\nnp.random.seed(20240902)\nk = np.linspace(0, var_samples.max(), 500)\ny = chi2.pdf(k, df=19)\nplt.plot(k, y, color=\"red\")\n```\n\n::: {.cell-output .cell-output-display}\n![](chi_files/figure-html/cell-16-output-1.png){width=579 height=411}\n:::\n:::\n\n\n",
    "supporting": [
      "chi_files"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\" data-relocate-top=\"true\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}